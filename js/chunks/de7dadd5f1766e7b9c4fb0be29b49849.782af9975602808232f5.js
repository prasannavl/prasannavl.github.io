webpackJsonp(["de7dadd5f1766e7b9c4fb0be29b49849"],{"./src/components/Article.jsx":function(a,b,c){"use strict";function d(a,b){var c={};for(var d in a)0<=b.indexOf(d)||Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);return c}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var h=c("./node_modules/react/index.js"),i=c.n(h),j=c("./src/components/Head.jsx"),k=c("./node_modules/date-fns/format/index.js"),l=c.n(k),m=c("./src/modules/prism.worker.js"),n=c.n(m),o=c("./node_modules/classnames/index.js"),p=c.n(o),q=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},r=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),s=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={code:null},c.workerState=null,c.workerTask=null,c.worker=null,c}return g(b,a),r(b,[{key:"highlight",value:function(a){var b=this,c=a.children,d=a.lang;if(d){c=this.trimChildString(c);var e=this.workerTask=this.worker.highlight({code:c.toString(),lang:d}).then(function(a){e===b.workerTask&&b.setState({code:a})}).catch(function(a){return console.log(a)})}}},{key:"componentWillMount",value:function(){window.highlightWorkerState||(window.highlightWorkerState={worker:new n.a,ref:0}),this.workerState=window.highlightWorkerState,this.workerState.ref++,this.worker=this.workerState.worker,this.highlight(this.props)}},{key:"componentDidUpdate",value:function(a){this.props!=a&&this.highlight(a)}},{key:"componentWillUnmount",value:function(){this.workerState.ref--,0===this.workerState.ref&&(this.worker.terminate(),window.highlightWorkerState=null),this.workerTask=null,this.workerState=null,this.worker=null}},{key:"trimChildString",value:function(a){return"string"==typeof a&&a.startsWith("\n")?a.trim():a}},{key:"render",value:function(){var a=this.props,b=a.children,c=a.lang,e=a.className,f=d(a,["children","lang","className"]);b=this.state.code?this.state.code:this.trimChildString(b);var g=-1===b.indexOf("\n"),i=p()(e,{"single-line":g}),j=void 0;return j=i?{className:i}:{},Object(h.createElement)("pre",q({},f,j),Object(h.createElement)("code",{dangerouslySetInnerHTML:{__html:b}}))}}]),b}(i.a.Component),t=c("./src/components/Link.jsx");c.d(b,"a",function(){return u}),c.d(b,"b",function(){return s}),c.d(b,"c",function(){return t.a}),c.d(b,!1,function(){});var u=function(a){var b=a.title,c=a.date,d=a.modifiedDate,e=a.image,f=a.type,g=a.children,i=a.note,k="Prasanna Loganathar",m=a.description||(i?"Prasanna's personal notes on ":"Prasanna's blog article published on ")+new Date(c).toUTCString(),n=window.location.pathname.startsWith("/drafts");return Object(h.createElement)("article",null,Object(h.createElement)(j.b,null,b),Object(h.createElement)(j.c,{title:b,description:m,image:e}),Object(h.createElement)(j.a,{title:b,description:m,image:e,url:window.location.href,type:f||"article",author:k,time:c,modifiedTime:d}),Object(h.createElement)("header",{className:"mb-4"},Object(h.createElement)("h1",{className:"title",rel:"title"},b),Object(h.createElement)("p",{className:"d-none",rel:"author"},k),Object(h.createElement)("p",{className:"small text-muted",rel:"date"},Object(h.createElement)("time",{dateTime:c},l()(new Date(c),"dddd, Do MMM YYYY")))),n&&Object(h.createElement)("p",{className:"note-red"},"This is a ",Object(h.createElement)("strong",null,"draft")," - a work in progress. It's not yet meant for public consumption till it's published."),a.note&&Object(h.createElement)("p",{className:"note"},"This item is marked as a ",Object(h.createElement)("code",null,"note"),". ",Object(h.createElement)("em",null,"Notes")," are my personal archive of mostly tiny bits of information that serve as reference. It ",Object(h.createElement)("strong",null,"may or may not")," be accurate. ",Object(h.createElement)("strong",null,"You have been warned"),"."),g)}},"./src/modules/prism.worker.js":function(a,b,c){var d=c("./node_modules/workerize-loader/dist/rpc-wrapper.js"),e=["highlight"];a.exports=function(){var a=new Worker(c.p+"js/workers/main.f7818a85dcc0292261c3.worker.js",{name:"js/workers/[id].[chunkhash].worker.js"});return d(a,e),a}},"./src/posts/2013/04/javascript-locks.jsx":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c.d(b,"meta",function(){return g});var d=c("./node_modules/react/index.js"),e=c.n(d),f=c("./src/components/Article.jsx"),g={title:"Javascript Locks",date:"2013-04-27T00:00:00.000Z",tags:["javascript"],description:"Priority based work queues that emulate locking mechanism in JavaScript"};b["default"]=function(){return Object(d.createElement)(f.a,g,Object(d.createElement)("p",{className:"note-red"},Object(d.createElement)("strong",null,"Note:")," This article is here ",Object(d.createElement)("em",null,"only for historical reasons"),". ",Object(d.createElement)("strong",null,"Do not ever do this"),", unless you know what you're doing. Also note that this is more of a task library than just for locking - this was a way to solve a particular problem I was facing. That being said, this is almost always a wrong approach for any problem in today's javascript ecosystem. :)"),Object(d.createElement)("p",null,"Things break. Codes break. Javascript - they don't just break, they break everything along with it. Being the simplest language has its downsides. But one of the common reasons that happen is people tend to forget that everything in JS is asynchronous."),Object(d.createElement)("p",null,"You probably would get away with it, if you're writing simple applications. But when complexity increases, it almost becomes impossible to solve certain problems with the async design pattern, not without a locking mechanism. Especially, in a javascript environment due to its full async nature making timing absolutely unreliable and unpredictable. While locking is common in a multi-thread environment, Js in most common environments will run on a single-thread and due to only simple tasks being performed with it, the old days never saw a need for locking. But for today's complex applications, you just need performant and reliable locking. There's no way around it."),Object(d.createElement)("p",null,"And that's exactly what the below tiny (<2kb) library provides."),Object(d.createElement)("p",null,Object(d.createElement)("b",null,"GitHub: "),Object(d.createElement)("a",{href:"https://github.com/prasannavl/JsLocks"},Object(d.createElement)("s",null,"https://github.com/prasannavl/JsLocks"))," [No longer available] ",Object(d.createElement)("br",null),Object(d.createElement)("b",null,"Download: "),Object(d.createElement)("a",{href:"https://raw.github.com/prasannavl/JsLocks/master/JsLocks.min.js"},Object(d.createElement)("s",null,"JsLocks.min.js"))," [No longer available]"),Object(d.createElement)("h2",null,"API"),Object(d.createElement)(f.b,{lang:"js",children:"\nLocker.Lock(lockName, callbackFunction, [priority=0]);\nLocker.LockManual(lockName, callbackFunction, [priority=0]);\nLocker.Release(lockName);\n\nLocker.DiscardQueue(lockName);\n\nLocker.LockManualIfInstant(lockName, callbackFunction, [priority=0]);\nLocker.LockIfInstant(lockName, callbackFunction, [priority=0]);\n        "}),Object(d.createElement)("h2",null,"Basic usage"),Object(d.createElement)(f.b,{lang:"js",children:"\nfunction getALife() {\n    \xA0\xA0\xA0 Locker.Lock(\"thebiglock\", function() {\n\xA0\xA0\xA0\xA0\xA0\xA0\xA0 DoSomeWork();\n\xA0\xA0\xA0\xA0\xA0\xA0\xA0 FetchNewAjaxContentAndReplaceMyMainContent();\n\xA0\xA0\xA0 });\n};\n        "}),Object(d.createElement)("p",null,"You could see how the above just cannot work without locking. Without this locking, executing getALife even twice in a row, basically ruins your life. Since you have no idea when you'll get the ajax request back. You have no way of knowing if they will work in order. Instead, your requests will get mangled up, and you have no way to load items in parallel without messing up the order. While this is a simple example, its uses go much further."),Object(d.createElement)("p",null,"The above is a auto-release lock. If you want manual control over the locks, just use the ManualLock and Release functions. It'd be incredibly useful to nest it deep down in the async callback hierarchy. Say, to couple it with jQuery animate's call back."),Object(d.createElement)(f.b,{lang:"js",children:"\nLocker.LockManual(\"thebiglock\", function() {\n    DoSomeWork();\n    $(\"MyLife\").animate( \"fast\", function() {\n        FetchNewAjaxContentAndReplaceMyMainContent();\n        Locker.Release(\"thebiglock\");\n    });\n});\n        "}),Object(d.createElement)("p",null,"Now this makes it work exactly as you'd except. And you can call the Locker.Release from anywhere, even from an external call or not even at all (of course, in which case your tasks are going to keep getting piled up until you do.)"),Object(d.createElement)("p",null,"And last but not the least - Priorities."),Object(d.createElement)(f.b,{lang:"js",children:"\nLocker.Lock(\"thebiglock\", function() {\n    DoSomeWork();\n    FetchNewAjaxContentAndReplaceMyMainContent();\n}, 20);\n        "}),Object(d.createElement)("p",null,"The default priority of jobs is 10.  Higher the value, higher the priority."),Object(d.createElement)("h2",null,"Priority values example"),Object(d.createElement)(f.b,{lang:"js",children:"\nvar test = function(no) {\n    var priority = Math.ceil(Math.random() * 10);\n    Locker.Lock(\"t1\", function () { \n            console.log(\"Task no: \" + no + \", Priority: \" + priority);\n    }, priority);\n};\n\n\nfor (var i=0; i<10; i++)\n{ \n    test(i);\n}\n        "}),Object(d.createElement)("h2",null,"Output"),Object(d.createElement)("samp",null,Object(d.createElement)(f.b,{children:"\nTask no: 0, Priority: 8\nTask no: 1, Priority: 8\nTask no: 4, Priority: 7\nTask no: 6, Priority: 7\nTask no: 9, Priority: 7\nTask no: 8, Priority: 5\nTask no: 2, Priority: 3\nTask no: 5, Priority: 3\nTask no: 7, Priority: 1\nTask no: 3, Priority: 1\n        "})),Object(d.createElement)("p",null,"As you'd expect, the locking mechanism makes it a reliable tasking system. Extend, modify and utilize it at will. Have fun!"))}}});